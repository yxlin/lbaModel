% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R, R/lbaModel.R
\name{dlba}
\alias{dlba}
\alias{plba}
\alias{theoretical_dlba}
\alias{theoretical_plba}
\alias{lba_distributions}
\title{LBA Distribution Functions}
\usage{
dlba(rt_r, parameter_r, is_positive_drift_r)

plba(rt_r, parameter_r, is_positive_drift_r, time_parameter_r)

theoretical_dlba(parameter_r, is_positive_drift_r, time_parameter_r)

theoretical_plba(parameter_r, is_positive_drift_r, time_parameter_r)
}
\arguments{
\item{rt_r}{For 'dlba' and 'plba': A numeric vector of observed response
times}

\item{parameter_r}{A numeric matrix of parameters where rows represent:
\itemize{
  \item Starting point variability (A)
  \item Thresholds (b)
  \item Mean drift rates (mean_v)
  \item The standard deviation of the drift rates (sd_v)
  \item The variability of the non-decision time (st0)
  \item Non-decision time (t0)
}. Each column represents parameters for an accumulator.}

\item{is_positive_drift_r}{A logical vector indicating whether drift rates
are positive}

\item{time_parameter_r}{For theoretical functions, a numeric vector to set
minimal  decison time, maximal decison time, and the different time. The 
internal mechanism uses this vector to set fine time points for evaluation.}
}
\value{
For all functions: A list containing:
\itemize{
  \item `values` - The computed distribution values
  \item `time_points` - The time points used (for theoretical functions 
and 'plba')
  \item Additional diagnostic information when applicable
}
}
\description{
The functions, \code{dlba}, \code{plba}, 
\code{theoretical_dlba}, and \code{theoretical_plba}, calculate probability
distributions for the Linear Ballistic Accumulator model:
\itemize{
  \item 'dlba' - Probability density function (PDF) for observed
choice response times
  \item 'plba' - Cumulative distribution function (CDF) for observed
choice response times
  \item 'theoretical_dlba' - Theoretical density function sets a
time range and computes the density for this range.
  \item `theoretical_plba' - Theoretical cumulative distribution function
sets a time range and computes the cumulative density for this range.
}
}
\details{
These functions provide the computational foundation for the LBA model:
\describe{
  \item{`dlba`}{Computes the probability density for observed response times,
  used during model fitting and likelihood calculations}
  \item{`plba`}{Computes the cumulative probability for observed response 
times, useful for model validation and goodness-of-fit tests}
  \item{`theoretical_dlba`}{Computes the theoretical PDF for diagnostic 
purposes and prediction}
  \item{`theoretical_plba`}{Computes the theoretical CDF for model 
validation and comparison with empirical data}
}
}
\examples{
###################################################
# Example 1: theoretical_dlba and theoretical_plba
###################################################

param_list2mat <- function(param_list) {
  n_row <- length(param_list[[1]])
  n_col <- length(param_list)
  out <- matrix(NA, nrow = n_row, ncol = n_col)

  for (i in seq_len(n_col)) {
    out[, i] <- param_list[[i]]
  }
  t(out)
}

params_tmp <- list(
  A = c(0.5, 0.5),
  b = c(1.0, 1.0),
  mean_v = c(2.0, 1.0),
  sd_v = c(1.0, 1.0),
  st0 = c(0.0, 0.0),
  t0 = c(0.2, 0.2)
)

dt <- 0.01
min_dt <- 0
max_dt <- 5
DT <- seq(min_dt, max_dt, dt)

time_parameter_r <- c(min_dt, max_dt, dt)

params <- param_list2mat(params_tmp)
nv <- ncol(params)
is_positive_drift <- rep(TRUE, nv)

pdf_densities <- theoretical_dlba(
  params, is_positive_drift, time_parameter_r
)


cdf_densities <- theoretical_plba(
  params, is_positive_drift, time_parameter_r
)


pdf_all <- pdf_densities[[1]] * dt + pdf_densities[[2]] * dt
cdf_all <- cdf_densities[[1]] + cdf_densities[[2]]
res1 <- cumsum(pdf_all)
res2 <- cdf_all

res3 <- res1[length(pdf_all)]
res4 <- cdf_all[length(cdf_all)]
cat("The cumulative densities, [PDF, CDF] = [", res3, ", ", res4, "]\n")

d_pdf <- data.frame(
  x = rep(DT, 2), y = c(
    pdf_densities[[1]] * dt,
    pdf_densities[[2]] * dt
  ),
  gp = rep(c("Accumulator 1", "Accumulator 2"), each = length(DT))
)

d_cdf <- data.frame(
  x = rep(DT, 2), y = c(res1, res2),
  gp = rep(c("Cumulated PDF", "CDF"), each = length(DT))
)
# Compute theoretical densities
pdf_densities <- theoretical_dlba(params, is_positive_drift, 
 time_parameter_r)
cdf_densities <- theoretical_plba(params, is_positive_drift, 
 time_parameter_r)
pdf_all <- pdf_densities[[1]] * dt + pdf_densities[[2]] * dt
cdf_all <- cdf_densities[[1]] + cdf_densities[[2]]
res1 <- cumsum(pdf_all)
res2 <- cdf_all
res3 <- res1[length(pdf_all)]
res4 <- cdf_all[length(cdf_all)]
cat("The cumulative densities, [PDF, CDF] = [", res3, ", ", res4, "]\n")

par(mfrow = c(2, 1), mar = c(5, 5, 2, 1))
# PDF plot
plot(DT, pdf_densities[[1]] * dt, type = "l", col = "blue", 
     ylim = c(0, max(pdf_all)), xlab = "DT", ylab = "Density", 
     main = "Theoretical PDF")

lines(DT, pdf_densities[[2]] * dt, col = "red")
legend("topright", legend = c("Accumulator 1", "Accumulator 2"),
       col = c("blue", "red"), lty = 1, bty = "n")

# CDF plot
plot(DT, res1, type = "l", col = "blue", ylim = c(0, 1),
     xlab = "DT", ylab = "Cumulative", main = "Cumulated PDF and CDF")
lines(DT, res2, col = "red")
legend("bottomright", legend = c("Cumulated PDF", "CDF"),
       col = c("blue", "red"), lty = 1, bty = "n")

###################################################
# Example 2: plba (Base R Plotting)
###################################################
# Parameter setup
params_tmp <- list(
  A = c(0.5, 0.5),
  b = c(1.0, 1.0),
  mean_v = c(2.0, 1.0),
  sd_v = c(1.0, 1.0),
  st0 = c(0.0, 0.0),
  t0 = c(0.2, 0.2)
)
params <- param_list2mat(params_tmp)
nv <- ncol(params)
is_positive_drift <- rep(TRUE, nv)
# Response times (shifted by non-decision time)
RT <- seq(0, 3, 0.001) + params[6, 1]
# Different dt setups
time_param1 <- c(0, 10, 0.0001)
time_param2 <- c(0, 5, 0.1)
time_param3 <- c(0, 5, 0.2)
cdf1 <- plba(RT, params, is_positive_drift, time_param1)
cdf2 <- plba(RT, params, is_positive_drift, time_param2)
cdf3 <- plba(RT, params, is_positive_drift, time_param3)

par(mfrow = c(1, 1), mar = c(5, 5, 2, 2))
plot(RT, cdf1[[1]], type = "l", ylim = c(0, 1), xlab = "RT", ylab = "CDF",
     main = "LBA CDF Estimates under Different Time Grids", col = "black",
     lwd = 2)
lines(RT, cdf1[[2]], col = "black", lwd = 2, lty = 2)
lines(RT, cdf2[[1]], col = "red", lwd = 2)
lines(RT, cdf2[[2]], col = "red", lwd = 2, lty = 2)
lines(RT, cdf3[[1]], col = "blue", lwd = 2)
lines(RT, cdf3[[2]], col = "blue", lwd = 2, lty = 2)
legend("bottomright",
       legend = c("Acc1 (dt=0.0001)", "Acc2 (dt=0.0001)",
                  "Acc1 (dt=0.1)", "Acc2 (dt=0.1)",
                  "Acc1 (dt=0.2)", "Acc2 (dt=0.2)"),
       col = c("black", "black", "red", "red", "blue", "blue"),
       lty = c(1, 2, 1, 2, 1, 2), lwd = 2, bty = "n")
}
